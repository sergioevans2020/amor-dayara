<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Minijuego Coraz칩n Saltar칤n 游눘</title>
<style>
  body, html {
    margin: 0; padding: 0;
    background: linear-gradient(135deg, #ffdde1, #ee9ca7);
    font-family: 'Quicksand', sans-serif;
    overflow: hidden;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    user-select: none;
    color: #b30059;
  }
  h1 {
    font-family: 'Great Vibes', cursive;
    margin-bottom: 10px;
    font-size: 3rem;
  }
  #nivel {
    margin-bottom: 20px;
    font-weight: 700;
    font-size: 1.5rem;
  }
  canvas {
    background: #fff0f6;
    border-radius: 20px;
    box-shadow: 0 0 30px #d63384aa;
    display: block;
  }
  #puntaje {
    margin-top: 15px;
    font-size: 1.2rem;
    font-weight: 600;
  }
  #btn-reiniciar {
    margin-top: 15px;
    padding: 10px 30px;
    font-size: 18px;
    background-color: #d63384;
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-weight: bold;
    display: none;
  }
  #btn-reiniciar:hover {
    background-color: #a5275c;
  }
</style>
</head>
<body>

  <h1>Coraz칩n Saltar칤n 游눘</h1>
  <div id="nivel">Nivel: F치cil</div>
  <canvas id="juego" width="600" height="150" aria-label="Juego de saltar coraz칩n"></canvas>
  <div id="puntaje">Puntuaci칩n: 0</div>
  <button id="btn-reiniciar" aria-label="Reiniciar juego">Reiniciar</button>

<script>
(() => {
  const canvas = document.getElementById('juego');
  const ctx = canvas.getContext('2d');

  // Tama침os y posiciones
  const sueloY = canvas.height - 30;
  const gravedad = 0.7;
  let puntaje = 0;
  let velocidad = 6;
  let nivel = 1;

  // Niveles: 1 - F치cil, 2 - Intermedio, 3 - Dif칤cil
  const nivelesTexto = ['F치cil', 'Intermedio', 'Dif칤cil'];
  const nivelElem = document.getElementById('nivel');
  const puntajeElem = document.getElementById('puntaje');
  const btnReiniciar = document.getElementById('btn-reiniciar');

  // Avatar Coraz칩n kawai con pies
  const avatar = {
    x: 50,
    y: sueloY,
    width: 40,
    height: 40,
    dy: 0,
    saltando: false,
    saltarFuerza: -15,
    piesAltura: 10,

    dibujar() {
      ctx.save();
      ctx.translate(this.x, this.y);

      // Cuerpo: coraz칩n rotado 45춿
      ctx.fillStyle = '#e91e63';
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.lineTo(this.width / 2, -this.height / 2);
      ctx.arc(this.width / 4, -this.height / 2, this.width / 4, Math.PI, 0, false);
      ctx.arc(this.width * 3 / 4, -this.height / 2, this.width / 4, Math.PI, 0, false);
      ctx.lineTo(this.width, 0);
      ctx.closePath();
      ctx.fill();

      // Ojos kawai
      ctx.fillStyle = 'white';
      ctx.beginPath();
      ctx.ellipse(this.width * 0.35, -this.height * 0.6, 6, 8, 0, 0, 2 * Math.PI);
      ctx.ellipse(this.width * 0.65, -this.height * 0.6, 6, 8, 0, 0, 2 * Math.PI);
      ctx.fill();
      ctx.fillStyle = '#b30059';
      ctx.beginPath();
      ctx.ellipse(this.width * 0.35, -this.height * 0.6, 3, 4, 0, 0, 2 * Math.PI);
      ctx.ellipse(this.width * 0.65, -this.height * 0.6, 3, 4, 0, 0, 2 * Math.PI);
      ctx.fill();

      // Brillo ojos
      ctx.fillStyle = 'white';
      ctx.beginPath();
      ctx.arc(this.width * 0.37, -this.height * 0.63, 2, 0, 2 * Math.PI);
      ctx.arc(this.width * 0.67, -this.height * 0.63, 2, 0, 2 * Math.PI);
      ctx.fill();

      // Pies (dos peque침os corazones rotados)
      ctx.fillStyle = '#b30059';
      // pie izquierdo
      ctx.save();
      ctx.translate(this.width * 0.2, 0);
      ctx.rotate(45 * Math.PI / 180);
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.lineTo(10, 10);
      ctx.arc(5, 0, 5, 0, Math.PI * 2);
      ctx.closePath();
      ctx.fill();
      ctx.restore();

      // pie derecho
      ctx.save();
      ctx.translate(this.width * 0.7, 0);
      ctx.rotate(45 * Math.PI / 180);
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.lineTo(10, 10);
      ctx.arc(5, 0, 5, 0, Math.PI * 2);
      ctx.closePath();
      ctx.fill();
      ctx.restore();

      ctx.restore();
    },

    actualizar() {
      this.dy += gravedad;
      this.y += this.dy;
      if (this.y > sueloY) {
        this.y = sueloY;
        this.dy = 0;
        this.saltando = false;
      }
    },

    saltar() {
      if (!this.saltando) {
        this.dy = this.saltarFuerza;
        this.saltando = true;
      }
    }
  };

  // Obst치culos - peque침os y variados
  class Obstaculo {
    constructor() {
      this.width = 15 + Math.random() * 10;
      this.height = 20 + Math.random() * 10;
      this.x = canvas.width + this.width;
      this.y = sueloY + avatar.piesAltura - this.height;
      this.color = '#b30059';
      this.velocidad = velocidad;
    }
    dibujar() {
      ctx.fillStyle = this.color;
      // Forma coraz칩n peque침o con pies
      ctx.save();
      ctx.translate(this.x, this.y);
      ctx.rotate(45 * Math.PI / 180);
      // cuerpo
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.lineTo(this.width / 2, -this.height / 2);
      ctx.arc(this.width / 4, -this.height / 2, this.width / 4, Math.PI, 0, false);
      ctx.arc(this.width * 3 / 4, -this.height / 2, this.width / 4, Math.PI, 0, false);
      ctx.lineTo(this.width, 0);
      ctx.closePath();
      ctx.fill();
      // pies (simplificados)
      ctx.fillRect(this.width * 0.2, 0, 4, 6);
      ctx.fillRect(this.width * 0.6, 0, 4, 6);
      ctx.restore();
    }
    actualizar() {
      this.x -= this.velocidad;
    }
  }

  let obstaculos = [];
  let frameCount = 0;
  let gameOver = false;

  function detectarColision(av, ob) {
    // Simple bounding box mejorada con zona coraz칩n
    const avBox = {
      x: av.x,
      y: av.y - av.height,
      width: av.width,
      height: av.height
    };
    const obBox = {
      x: ob.x,
      y: ob.y,
      width: ob.width,
      height: ob.height
    };

    return (
      avBox.x < obBox.x + obBox.width &&
      avBox.x + avBox.width > obBox.x &&
      avBox.y < obBox.y + obBox.height &&
      avBox.y + avBox.height > obBox.y
    );
  }

  function mostrarGameOver() {
    ctx.fillStyle = 'rgba(255, 255, 255, 0.85)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#b30059';
    ctx.font = 'bold 36px Quicksand, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('춰Game Over!', canvas.width / 2, canvas.height / 2 - 20);
    ctx.font = '22px Quicksand, sans-serif';
    ctx.fillText(`Puntuaci칩n: ${puntaje}`, canvas.width / 2, canvas.height / 2 + 20);
    btnReiniciar.style.display = 'inline-block';
  }

  function actualizarNivel() {
    if (puntaje >= 40) {
      nivel = 3;
      velocidad = 12;
    } else if (puntaje >= 20) {
      nivel = 2;
      velocidad = 9;
    } else {
      nivel = 1;
      velocidad = 6;
    }
    nivelElem.textContent = `Nivel: ${nivelesTexto[nivel -1]}`;
  }

  function reiniciarJuego() {
    obstaculos = [];
    puntaje = 0;
    frameCount = 0;
    gameOver = false;
    velocidad = 6;
    nivel = 1;
    nivelElem.textContent = `Nivel: ${nivelesTexto[0]}`;
    puntajeElem.textContent = `Puntuaci칩n: 0`;
    btnReiniciar.style.display = 'none';
    avatar.y = sueloY;
    avatar.dy = 0;
    avatar.saltando = false;
    requestAnimationFrame(loop);
  }

  function loop() {
    if (gameOver) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Suelo
    ctx.fillStyle = '#d63384';
    ctx.fillRect(0, sueloY + avatar.piesAltura, canvas.width, canvas.height - sueloY);

    avatar.actualizar();
    avatar.dibujar();

    // Crear obst치culo cada cierto frames segun dificultad
    if (frameCount % Math.floor(60 - nivel * 10) === 0) {
      obstaculos.push(new Obstaculo());
    }

    for (let i = 0; i < obstaculos.length; i++) {
      const ob = obstaculos[i];
      ob.velocidad = velocidad;
      ob.actualizar();
      ob.dibujar();

      if (detectarColision(avatar, ob)) {
        gameOver = true;
        mostrarGameOver();
        return;
      }

      if (ob.x + ob.width < 0) {
        obstaculos.splice(i, 1);
        i--;
        puntaje++;
        puntajeElem.textContent = `Puntuaci칩n: ${puntaje}`;
        actualizarNivel();
      }
    }

    frameCount++;
    requestAnimationFrame(loop);
  }

  // Control saltar con click o tecla espacio / flecha arriba
  window.addEventListener('keydown', (e) => {
    if ((e.code === 'Space' || e.code === 'ArrowUp') && !gameOver) {
      e.preventDefault();
      avatar.saltar();
    }
  });

  canvas.addEventListener('click', () => {
    if (!gameOver) avatar.saltar();
  });

  btnReiniciar.addEventListener('click', () => {
    reiniciarJuego();
  });

  // Empieza el juego
  reiniciarJuego();

})();
</script>
</body>
</html>
